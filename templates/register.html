{% extends "base.html" %}
{% block title %}Registrar usuario{% endblock %}

{% block content %}
<div class="max-w-md mx-auto mt-10 bg-white p-6 rounded-xl shadow">
  <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">游녻 Registro de usuario</h2>

  <form method="POST" onsubmit="return validarFormulario()">
    <div class="mb-4">
      <label for="email" class="block text-sm font-medium text-gray-700">Correo electr칩nico</label>
      <input type="email" name="email" id="email" required
             class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
    </div>

    <!-- Campo Contrase침a -->
    <div class="mb-4">
      <label for="password" class="block text-sm font-medium text-gray-700">Contrase침a</label>
      <div class="relative">
        <input type="password" name="password" id="password" required
               class="mt-1 block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
        <button type="button" onclick="togglePassword('password')" class="absolute right-3 top-2.5 text-gray-500 text-sm">
          游녜
        </button>
      </div>
    </div>

    <!-- Campo Confirmar Contrase침a -->
    <div class="mb-4">
      <label for="confirm_password" class="block text-sm font-medium text-gray-700">Confirmar contrase침a</label>
      <div class="relative">
        <input type="password" name="confirm_password" id="confirm_password" required
               class="mt-1 block w-full px-3 py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
        <button type="button" onclick="togglePassword('confirm_password')" class="absolute right-3 top-2.5 text-gray-500 text-sm">
          游녜
        </button>
      </div>
    </div>

    <!-- Bot칩n para generar contrase침a -->
    <div class="mb-4 text-right">
      <button type="button" onclick="generarPassword()" class="text-sm text-blue-600 hover:underline">
        游댏 Generar contrase침a segura
      </button>
    </div>

    <!-- Rol -->
    <div class="mb-4">
      <label for="rol" class="block text-sm font-medium text-gray-700">Rol del usuario</label>
      <select name="rol" id="rol"
              class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
        <option value="empleado" selected>Empleado</option>
        <option value="admin">Administrador</option>
      </select>
    </div>

    <!-- Bot칩n -->
    <div class="flex justify-end">
      <button type="submit"
              class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium px-4 py-2 rounded">
        Registrar
      </button>
    </div>
  </form>
</div>

<!-- Scripts -->
<script>
  function togglePassword(id) {
    const field = document.getElementById(id);
    field.type = field.type === 'password' ? 'text' : 'password';
  }

  function generarPassword() {
    const caracteres = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+";
    let password = "";
    for (let i = 0; i < 12; i++) {
      password += caracteres.charAt(Math.floor(Math.random() * caracteres.length));
    }
    document.getElementById("password").value = password;
    document.getElementById("confirm_password").value = password;
    alert("Contrase침a generada autom치ticamente");
  }

  function validarFormulario() {
    const password = document.getElementById("password").value;
    const confirm = document.getElementById("confirm_password").value;

    if (password !== confirm) {
      alert("Las contrase침as no coinciden");
      return false;
    }

    const regexFuerte = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
    if (!regexFuerte.test(password)) {
      alert("La contrase침a debe tener m칤nimo 8 caracteres, incluyendo may칰sculas, min칰sculas, n칰meros y s칤mbolos.");
      return false;
    }

    return true;
  }
</script>
{% endblock %}


